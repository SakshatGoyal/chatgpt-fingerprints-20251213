# OCR of cart products

## You (2025-12-08T19:01:39.993000+00:00)

In this file you will find a series of different cart pages under different company/brand names. For each brand, I need you to do an OCR of all the products in the cart. Since these are screenshots, I'm not able to directly copy all the content.



## ChatGPT (2025-12-08T19:02:24.311761+00:00)

from pptx import Presentation
prs = Presentation("/mnt/data/Colibri Brands Cart Pages.pptx")
len(prs.slides)



## ChatGPT (2025-12-08T19:02:37.597698+00:00)

for i, slide in enumerate(prs.slides[:10]):
    print("Slide", i+1)
    texts = []
    for shape in slide.shapes:
        if hasattr(shape, "text"):
            texts.append(shape.text)
    print("\n---\n".join(texts))
    print("="*80)



## ChatGPT (2025-12-08T19:02:46.990939+00:00)

from pptx import Presentation
prs = Presentation("/mnt/data/Colibri Brands Cart Pages.pptx")
for idx, slide in enumerate(prs.slides):
    print("Slide", idx+1)
    for shape in slide.shapes:
        if hasattr(shape, "text"):
            print(shape.text)
    print("="*60)
    if idx >= 9:
        break



## ChatGPT (2025-12-08T19:02:59.464711+00:00)

import pytesseract, PIL, sys, os, textwrap, math



## ChatGPT (2025-12-08T19:03:13.252101+00:00)

from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image
import io, pytesseract, os, textwrap

# Find first slide with a picture
img = None
for slide in prs.slides:
    for shape in slide.shapes:
        if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
            image_blob = shape.image.blob
            img = Image.open(io.BytesIO(image_blob))
            break
    if img:
        break

img.size



## ChatGPT (2025-12-08T19:03:22.719262+00:00)

try:
    text = pytesseract.image_to_string(img)
    print(text)
except Exception as e:
    print("Error:", e)



## ChatGPT (2025-12-08T19:04:55.048254+00:00)

from pptx import Presentation
from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image
import io, pytesseract, textwrap, re

prs = Presentation("/mnt/data/Colibri Brands Cart Pages.pptx")

def get_slide_header(slide):
    texts = []
    for shape in slide.shapes:
        if hasattr(shape, "text") and shape.text.strip():
            texts.append(shape.text.strip())
    # Join but we expect one primary title
    return " | ".join(texts)

slides_data = []
for idx, slide in enumerate(prs.slides):
    header = get_slide_header(slide)
    img = None
    for shape in slide.shapes:
        if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
            img = Image.open(io.BytesIO(shape.image.blob))
            break
    if img is None:
        ocr_text = ""
    else:
        try:
            ocr_text = pytesseract.image_to_string(img)
        except Exception as e:
            ocr_text = f"[OCR ERROR: {e}]"
    slides_data.append({"index": idx+1, "header": header, "ocr": ocr_text})

len(slides_data), slides_data[0]["header"]



## ChatGPT (2025-12-08T19:06:18.701817+00:00)

from pptx import Presentation
prs = Presentation("/mnt/data/Colibri Brands Cart Pages.pptx")

headers = []
for idx, slide in enumerate(prs.slides):
    texts = [shape.text.strip() for shape in slide.shapes if hasattr(shape, "text") and shape.text.strip()]
    header = " | ".join(texts)
    headers.append((idx+1, header))

for h in headers:
    print(h)



## ChatGPT (2025-12-08T19:07:03.589966+00:00)

from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image
import io, pytesseract, textwrap

def ocr_slide(n):
    slide = prs.slides[n-1]
    # find first picture
    img = None
    for shape in slide.shapes:
        if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
            img = Image.open(io.BytesIO(shape.image.blob))
            break
    if img is None:
        return ""
    text = pytesseract.image_to_string(img)
    return text

for n in range(3, 7):
    print("=== Slide", n, "===")
    print(headers[n-1])  # from previous list: index, header
    print(ocr_slide(n))
    print("="*80)



## ChatGPT (2025-12-08T19:07:31.412150+00:00)

for n in range(3, 7):
    print("=== Slide", n, "===")
    slide = prs.slides[n-1]
    header_texts = [shape.text.strip() for shape in slide.shapes if hasattr(shape,"text") and shape.text.strip()]
    print("Header:", " | ".join(header_texts))
    img = None
    from pptx.enum.shapes import MSO_SHAPE_TYPE
    for shape in slide.shapes:
        if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
            img = Image.open(io.BytesIO(shape.image.blob))
            break
    if img:
        text = pytesseract.image_to_string(img)
        print(text)
    else:
        print("[No image]")
    print("="*80)



## ChatGPT (2025-12-08T19:07:54.787043+00:00)

from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image
import io, pytesseract

for n in range(3, 7):
    print("=== Slide", n, "===")
    try:
        slide = prs.slides[n-1]
        header_texts = [shape.text.strip() for shape in slide.shapes if hasattr(shape,"text") and shape.text.strip()]
        print("Header:", " | ".join(header_texts))
        img = None
        for shape in slide.shapes:
            if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
                img = Image.open(io.BytesIO(shape.image.blob))
                break
        if img:
            text = pytesseract.image_to_string(img)
            print(text)
        else:
            print("[No image]")
    except Exception as e:
        print("Error:", e)
    print("="*80)



## ChatGPT (2025-12-08T19:08:36.907846+00:00)

from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image
import io, pytesseract

n = 4
print("=== Slide", n, "===")
slide = prs.slides[n-1]
header_texts = [shape.text.strip() for shape in slide.shapes if hasattr(shape,"text") and shape.text.strip()]
print("Header:", " | ".join(header_texts))
img = None
for shape in slide.shapes:
    if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
        img = Image.open(io.BytesIO(shape.image.blob))
        break
if img:
    text = pytesseract.image_to_string(img)
    print(text)
else:
    print("[No image]")



## ChatGPT (2025-12-08T19:11:03.347067+00:00)

from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image
import io, pytesseract

for n in range(13, 17):
    print("=== Slide", n, "===")
    slide = prs.slides[n-1]
    header_texts = [shape.text.strip() for shape in slide.shapes if hasattr(shape,"text") and shape.text.strip()]
    print("Header:", " | ".join(header_texts))
    img = None
    for shape in slide.shapes:
        if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
            img = Image.open(io.BytesIO(shape.image.blob))
            break
    if img:
        text = pytesseract.image_to_string(img)
        print(text)
    else:
        print("[No image]")
    print("="*80)



## ChatGPT (2025-12-08T19:11:42.703762+00:00)

from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image
import io, pytesseract

def slide_ocr_lines(n):
    slide = prs.slides[n-1]
    img = None
    for shape in slide.shapes:
        if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
            img = Image.open(io.BytesIO(shape.image.blob))
            break
    if not img:
        return []
    text = pytesseract.image_to_string(img)
    lines = [ln.strip() for ln in text.splitlines() if ln.strip()]
    return lines

lines4 = slide_ocr_lines(4)
for ln in lines4:
    print(ln)



## ChatGPT (2025-12-08T19:14:20.407530+00:00)

from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image
import io, pytesseract

def ocr_lines(slide_index):
    slide = prs.slides[slide_index-1]
    img = None
    for shape in slide.shapes:
        if shape.shape_type == MSO_SHAPE_TYPE.PICTURE:
            img = Image.open(io.BytesIO(shape.image.blob))
            break
    if not img:
        return []
    text = pytesseract.image_to_string(img)
    lines = [ln.strip() for ln in text.splitlines() if ln.strip()]
    return lines

sample_indices = [3,4,5,6,7,8,9,10,11,12]  # some Colibri slides
for idx in sample_indices:
    print("=== Slide", idx, "===")
    slide = prs.slides[idx-1]
    header = " | ".join([s.text.strip() for s in slide.shapes if hasattr(s,"text") and s.text.strip()])
    print("Header:", header)
    try:
        lines = ocr_lines(idx)
        for ln in lines:
            print(" ", ln)
    except Exception as e:
        print("OCR error:", e)
    print("="*80)



## ChatGPT (2025-12-08T19:16:12.433217+00:00)

def extract_products_from_lines(lines):
    products = []
    stop_starts = [
        'subtotal', 'discount', 'grand total', 'due today', 'price', 'promo code',
        'promocode', 'tax', 'total:', 'total ', 'today:', 'balance', 'fees', 'sign in', 'sign-in'
    ]
    for l in lines:
        l_stripped = l.strip()
        low = l_stripped.lower()
        if ('$' in l_stripped) or ('free' in low):
            # skip if starts with any stopword
            if any(low.startswith(s) for s in stop_starts):
                continue
            # skip if line is like 'PRICE' or 'Free shipping' etc? hmm
            candidate = l_stripped
            # If 'Subtotal:' in candidate; we skip earlier; but safe.
            # Remove known trailing phrases
            # First cut at "Subtotal"
            for token in ['Subtotal', 'Discount', 'Promo Code', 'Grand Total', 'Due Today']:
                if token in candidate:
                    candidate = candidate.split(token)[0]
            # Now cut at first '$' if present
            if '$' in candidate:
                candidate = candidate.split('$')[0]
            # Cut at 'FREE' or 'Free' etc
            for token in ['FREE', 'Free', 'free']:
                if token in candidate:
                    candidate = candidate.split(token)[0]
            candidate = candidate.strip(" :-â€”")
            if candidate and len(candidate) > 2:
                products.append(candidate)
    # deduplicate while preserving order
    seen = set()
    uniq = []
    for p in products:
        if p not in seen:
            seen.add(p)
            uniq.append(p)
    return uniq

lines4 = slide_ocr_lines(4)
products4 = extract_products_from_lines(lines4)
lines4, products4
